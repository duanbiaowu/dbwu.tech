<!doctype html>

<html lang="en">

<head>
  <title>nc 命令常用操作 - 蛮荆</title>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="" />
<meta name="author" content="" />
<link rel="shortcut icon" href="https://dbwu.tech/favicon.ico" type="image/x-icon" /><meta property="og:title" content="nc 命令常用操作" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dbwu.tech/posts/linux/tools/nc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-01-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2017-01-18T00:00:00+00:00" />


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="nc 命令常用操作"/>
<meta name="twitter:description" content=""/>

<meta name="generator" content="Hugo 0.120.3">
    
    <script src="https://dbwu.tech/js/mathjax-config.js" defer></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CZMGTTFLNY"></script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3261056100776781" crossorigin="anonymous"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-CZMGTTFLNY');
  </script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>


  <link rel="stylesheet" href="https://dbwu.tech/fontawesome/css/normalize.min.css" />
  <link rel="stylesheet" href="https://dbwu.tech/fontawesome/css/all.min.css" />
  
    
    <link href="//fonts.googleapis.com/css?family=Staatliches" rel="stylesheet">
  
  
  <link rel="stylesheet" type="text/css" href="https://dbwu.tech/css/styles-light.css" />
  </head>

<body>
  <div id="container">
    <header>
      
      <h1>
        <a href="https://dbwu.tech/">蛮荆</a>
      </h1>

      <ul id="social-media">
      </ul>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="active" href="https://dbwu.tech/posts/">
                <i class="fa-li fa  fa-lg"></i><span>归档</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://dbwu.tech/tags/">
                <i class="fa-li fa  fa-lg"></i><span>标签</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://github.com/duanbiaowu">
                <i class="fa-li fa  fa-lg"></i><span>Github</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://dbwu.tech/index.xml">
                <i class="fa-li fa  fa-lg"></i><span>RSS</span>
            </a>
        </li>
        
    </ul>
</nav>


    <main>




<article>

    <h1>nc 命令常用操作</h1>

    
      
<p>
    <span>2017-01-18</span>
    
    
    <a class="article-tag" href="https://dbwu.tech/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C">计算机网络</a>
    
    
    <a class="article-tag" href="https://dbwu.tech/tags/linux-%E5%91%BD%E4%BB%A4">Linux 命令</a>
    
</p>

    

    
      

    

    <h2 id="nc-命令作用">nc 命令作用</h2>
<p><code>nc</code> 命令 (Netcat 的简称) 是一个强大的网络工具，可以在网络连接上面读取和写入数据，因为支持多种功能，如端口扫描、文件传输、端口监听、以及网络调试等，所以被称为 “网络瑞士军刀”。</p>
<p>nc 命令参数中的目标地址可以是域名，也可以是 IP 地址。</p>
<hr>
<h2 id="基本用法">基本用法</h2>
<h3 id="1-建立连接测试">1. 建立连接测试</h3>
<p>可以用于测试本地到目标地址的连通性 (TCP/UDP)。</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#999;font-style:italic"># nc IP 地址 端口号</span>
</span></span><span style="display:flex;"><span>$ nc 127.0.0.1 <span style="color:#3677a9">8080</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 没有异常提示，说明连接建立成功</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 使用 lsof 命令查看建立的连接</span>
</span></span><span style="display:flex;"><span>$ lsof -i:8080
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 输出如下</span>
</span></span><span style="display:flex;"><span>COMMAND     PID          USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME
</span></span><span style="display:flex;"><span>nc        <span style="color:#3677a9">77161</span>     dbwu.tech    3u  IPv4 0xab5a955319abcdef      0t0  TCP localhost:63984-&gt;localhost:bmc_patroldb (ESTABLISHED)
</span></span></code></pre></div><p>除了使用 IP 地址之外，也可以直接使用域名。</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ nc dbwu.tech <span style="color:#3677a9">80</span>
</span></span></code></pre></div><h3 id="2-端口扫描">2. 端口扫描</h3>
<p>扫描主机上的开放端口，可以指定某一个，也可以端口范围:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ nc -zv dbwu.tech <span style="color:#3677a9">80</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Connection to dbwu.tech port <span style="color:#3677a9">80</span> [tcp/http] succeeded!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ nc -zv dbwu.tech <span style="color:#3677a9">443</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Connection to dbwu.tech port <span style="color:#3677a9">443</span> [tcp/https] succeeded!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 如果指定端口号没有开放，命令输出会阻塞</span>
</span></span><span style="display:flex;"><span>$ nc -zv dbwu.tech <span style="color:#3677a9">12345</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 阻塞等待输出</span>
</span></span><span style="display:flex;"><span>... 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 指定范围端口号</span>
</span></span><span style="display:flex;"><span>$ nc -zv dbwu.tech 80-443
</span></span></code></pre></div><h3 id="3-创建简易聊天">3. 创建简易聊天</h3>
<p>创建一个简单的聊天服务端和客户端，用于本地网络编程调试程序。</p>
<p><strong>服务端监听 12345 端口</strong>：</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ nc -l <span style="color:#3677a9">12345</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 查看端口是否已监听</span>
</span></span><span style="display:flex;"><span>$ lsof -i:12345
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>COMMAND  PID          USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME
</span></span><span style="display:flex;"><span>nc      <span style="color:#3677a9">3772</span>     dbwu.tech    3u  IPv4      0x123456      0t0  TCP *:italk (LISTEN)
</span></span></code></pre></div><p><strong>客户端连接服务端</strong>：</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ nc 127.0.0.1 <span style="color:#3677a9">12345</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 连接之后，发送消息</span>
</span></span><span style="display:flex;"><span>hello server <span style="color:#999;font-style:italic"># 然后按回车</span>
</span></span></code></pre></div><p><strong>查看服务端数据</strong>：</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 服务端显示数据</span>
</span></span><span style="display:flex;"><span>hello server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 同时给客户端发送一个响应</span>
</span></span><span style="display:flex;"><span>hello client
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 返回到客户端，显示数据</span>
</span></span><span style="display:flex;"><span>hello client
</span></span></code></pre></div><h3 id="4-发送-udp-数据">4. 发送 UDP 数据</h3>
<p>向指定</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;Hello, UDP&#34;</span> | nc -u 172.67.147.110 <span style="color:#3677a9">53</span>
</span></span></code></pre></div><h3 id="5-指定源-ip-地址和源端口">5. 指定源 IP 地址和源端口</h3>
<p>-s 指定源 IP 地址
-p 指定源端口号</p>
<p>主要针对多网卡的主机。</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ nc -s 192.168.1.100 -p <span style="color:#3677a9">5678</span> 172.67.147.110 <span style="color:#3677a9">8080</span>
</span></span></code></pre></div><p>看到指定源 IP 地址，你也许会想到通过伪造 IP 来实现网络攻击？</p>
<p>但是这是不可行的，因为网络协议栈不允许通过未分配给本机的 IP 作为源 IP 地址，也就是说，即使在命令中伪造了一个源 IP 地址，数据包根本发不出去，因为协议栈无法找到相应的接口来发送数据，最后会返回错误。</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 伪造的源 IP 地址，直接操作失败</span>
</span></span><span style="display:flex;"><span>$ nc -s 1.1.1.1 -p <span style="color:#3677a9">5678</span> 172.67.147.110 <span style="color:#3677a9">8080</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 报错输出如下</span>
</span></span><span style="display:flex;"><span>nc: <span style="color:#24909d">bind</span> failed: Cannot assign requested address
</span></span></code></pre></div><h3 id="6-进行带宽测试">6. 进行带宽测试</h3>
<p>通过管道将数据传输到 <code>nc</code> 命令，可以进行本地到目标地址带宽测试。</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 向 dbwu.tech 发送 100 MB 数据进行带宽测试</span>
</span></span><span style="display:flex;"><span>$ dd <span style="color:#6ab825;font-weight:bold">if</span>=/dev/zero <span style="color:#40ffff">bs</span>=1M <span style="color:#40ffff">count</span>=<span style="color:#3677a9">100</span> | nc dbwu.tech <span style="color:#3677a9">443</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"># 输出如下</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HTTP/1.1 <span style="color:#3677a9">400</span> Bad Request
</span></span><span style="display:flex;"><span>Server: cloudflare
</span></span><span style="display:flex;"><span>Date: Fri, <span style="color:#3677a9">28</span> Jun <span style="color:#3677a9">2024</span> 08:53:22 GMT
</span></span><span style="display:flex;"><span>Content-Type: text/html
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>100+0 records in
</span></span><span style="display:flex;"><span>100+0 records out
</span></span><span style="display:flex;"><span><span style="color:#3677a9">104857600</span> bytes (<span style="color:#3677a9">105</span> MB, <span style="color:#3677a9">100</span> MiB) copied, 23.5049 s, 4.5 MB/s
</span></span></code></pre></div><p>通过输出结果可以看到，本地到 dbwu.tech 的网络带宽大约 4.5 MB/s 。</p>


</article>

<article>
    <img src="https://dbwu.tech/images/wechat.png">
</article>

<article>
    <h3>转载申请</h3>

    <p>
        本作品采用 <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">知识共享署名 4.0 国际许可协议</a> 进行许可，转载时请注明原文链接，图片在使用时请保留全部内容，商业转载请联系作者获得授权。
    </p>
</article>

<section class="post-nav">
    <ul>
        <li>
        
            <a href="https://dbwu.tech/posts/linux/tools/dns/"><i class="fa fa-chevron-circle-left"></i> DNS 命令行工具</a>
        
        </li>
        <li>
        
            <a href="https://dbwu.tech/posts/linux/tools/ifconfig/">ifconfig 命令 <i class="fa fa-chevron-circle-right"></i> </a>
        
        </li>
    </ul>
</section>
  
    
    
  


<script src="https://giscus.app/client.js"
        data-repo="duanbiaowu/dbwu.tech"
        data-repo-id="R_kgDOIkkjjw"
        data-category="Announcements"
        data-category-id="DIC_kwDOIkkjj84CV78j"
        data-mapping="specific"
        data-term="nc 命令常用操作"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="1"
        data-input-position="top"
        data-theme="light"
        data-lang="zh-CN"
        crossorigin="anonymous" async>
</script>




</main>
    <footer>
        <ul>
            <li>
                <h6><a href="mailto:codean.net@gmail.com">codean.net@gmail.com</a> | 
                    <img src="https://dbwu.tech/images/%E5%A4%87%E6%A1%88%E5%9B%BE%E6%A0%87.png" />
                    <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=61011302001681" target="_blank">陕公网安备 61011302001681 号</a> |
                    <a href="https://beian.miit.gov.cn" target="_blank">陕ICP备2023004378号-1</a> |
                    Rendered by <a href="https://themes.gohugo.io" title="Hugo" target="_blank">Hugo</a>
                </h6>
            </li>
            
            
        </ul>
    </footer>
</div>
<script src="https://dbwu.tech/js/scripts.js"></script>


</body>

</html>

